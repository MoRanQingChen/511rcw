<!DOCTYPE html>
<html class="ui-page-login">

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" />
		<title></title>
		<link href="css/mui.min.css" rel="stylesheet" />
		<link href="css/style.css" rel="stylesheet" />
		<style>

		</style>
	</head>

	<body>
		<header class="mui-bar mui-bar-nav">
			<a class="mui-action-back mui-icon mui-icon-left-nav mui-pull-left"></a>
			<h1 class="mui-title">注册511</h1>
		</header>
		<br />
		<br />
		<div class="mui-content">
			<form class="mui-input-group">
				<div class="mui-input-row">
					<label>账号:</label>
					<input id='account' type="text" class="mui-input-clear mui-input" placeholder="请输入用户名">
				</div>
				<div class="mui-input-row">
					<label>密码:</label>
					<input id='password' type="password" class="mui-input-clear mui-input" placeholder="请输入密码">
				</div>
				<div class="mui-input-row">
					<label>确认密码:</label>
					<input id='password_confirm' type="password" class="mui-input-clear mui-input" placeholder="请再次输入密码">
				</div>
				<div class="mui-input-row">
					<label>真实姓名:</label>
					<input id='RealName' type="text" class="mui-input-clear mui-input" placeholder="请输入真实姓名">
				</div>
				<div class="mui-input-row" id="chusheng">
					<label>出生日期:</label>
					<input id='birth' readonly="true" type="text" class="mui-input-clear mui-input" placeholder="选择出生日期">
				</div>
				<div class="mui-input-row">
					<label>电子邮箱:</label>
					<input id='email' type="text" class="mui-input-clear mui-input" placeholder="请输入电子邮箱">
				</div>
			</form>
			<br />
			<div class="mui-content-padded">
				<button id='reg' class="mui-btn mui-btn-block mui-btn-primary">注册</button>
			</div>
			<br />
			<div class="mui-content-padded">
				<p>欢迎加入511人才网！</p>
			</div>
		</div>
		<script src="js/mui.min.js"></script>
		<script src="js/ajax.js"></script>
		<script src="js/app.js"></script>
		<script type="text/javascript" src="app/js/ajax.js"></script>

		<script>
			(function($, doc) {
				$.init();
				document.getElementById("reg").addEventListener('tap', function() {
					if (document.getElementById("password").value != document.getElementById("password_confirm").value) {
						alert('两次密码不一致！')
						return;
					}
					
					var data = {
						t: 27,
						UserID: document.getElementById("account").value,
						UserPwd: document.getElementById("password").value,
						RealName: document.getElementById("RealName").value,
						Email: document.getElementById("email").value,
						birth: document.getElementById("birth").value
					}
					if(!/^\w{5,20}$/.test(data.UserID)){
						alert('用户名只能由5到20位字母和数字组成');
						return;
					}
					if(!/\w{6,20}/.test(data.UserPwd)){
						alert('密码只能由6到20位字母和数字组成');
						return;
					}
					if(!/^[\u4E00-\u9FA5]{2,5}$/.test(data.RealName)){
						alert('姓名格式不正确')
						return;
					}
					if(!/^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$/.test(data.Email)){
						alert('邮箱格式不正确')
						return;
					}
					console.log(data.birth);
					if(/\d+/.test(data.birth)){
						alert('未选择出生日期')
						return;
					}
					plus.nativeUI.showWaiting();
					jp('http://www.511rcw.com/app/AppHandler.ashx', data, function() {
						plus.nativeUI.closeWaiting();
						alert(arguments[0].msg);
						if (arguments[0].success == "true") mui.back();
					});
				});
				document.getElementById("chusheng").addEventListener('tap', function() {
					var dDate = new Date();
					dDate.setFullYear(dDate.getFullYear(), 9, 1);
					var minDate = new Date();
					minDate.setFullYear(1940, 0, 1);
					var maxDate = new Date();
					maxDate.setFullYear(2010, 0, 1);
					plus.nativeUI.pickDate(function(e) {
						var d = e.date;
						document.getElementById("birth").value = d.getFullYear() + "-" + (d.getMonth() + 1) + "-" + d.getDate();
					}, function(e) {
						document.getElementById("birth").value = ""
					}, {
						title: "请选择日期",
						date: dDate,
						minDate: minDate,
						maxDate: maxDate
					});
				})
			}(mui, document));
		</script>

	</body>

</html>